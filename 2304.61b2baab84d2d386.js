"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[2304],{2304:(Z,u,c)=>{c.r(u),c.d(u,{InviteFriendPageModule:()=>C});var d=c(4755),f=c(5030),s=c(626),h=c(2443),p=c(5861),_=c(8053),t=c(3020),m=c(3144);function x(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"tr",21),t.NdJ("click",function(){t.CHM(e);const o=t.oxw().$implicit,r=t.oxw();return t.KtG(r.openRowDetails(o.nom))}),t.TgZ(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA()()}if(2&i){const e=t.oxw().$implicit;t.xp6(2),t.Oqu(e.lib_agence),t.xp6(2),t.Oqu(e.prix)}}function b(i,a){if(1&i&&(t.ynx(0),t.YNc(1,x,5,2,"tr",20),t.BQk()),2&i){const e=a.$implicit;t.xp6(1),t.Q6J("ngIf",0!==e.prix)}}function M(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"tr",21),t.NdJ("click",function(){t.CHM(e);const o=t.oxw().$implicit,r=t.oxw();return t.KtG(r.openRowDetails(o.nom))}),t.TgZ(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA()()}if(2&i){const e=t.oxw().$implicit;t.xp6(2),t.Oqu(e.lib_agence),t.xp6(2),t.Oqu(e.prix)}}function P(i,a){if(1&i&&(t.ynx(0),t.YNc(1,M,5,2,"tr",20),t.BQk()),2&i){const e=a.$implicit;t.xp6(1),t.Q6J("ngIf",0!==e.prix)}}const y=[{path:"",component:(()=>{class i{constructor(e,n){this.http=e,this.router=n,this.currentDate=new Date,this.yesterday=new Date(this.currentDate),this.previousMonth=new Date(this.currentDate),this.nextMonth=new Date(this.currentDate),this.nextday=new Date((new Date).setDate((new Date).getDate()+30)).toISOString().split("T")[0],this.rows=[],this.moiss=[],this.muisss=[],this.totalPrixMoiss=0,this.totalPrixMuisss=0,this.serverUrl="",this.port="",this.apiBaseUrl="",this.initializeDates()}initializeDates(){this.yesterday=new Date(this.currentDate),this.yesterday.setDate(this.currentDate.getDate()-1),this.previousMonth=new Date(this.yesterday),this.previousMonth.setMonth(this.yesterday.getMonth()-1),this.nextMonth=new Date(this.currentDate),this.nextMonth.setMonth(this.currentDate.getMonth()+1)}loadConfig(){var e=this;return(0,p.Z)(function*(){e.serverUrl=localStorage.getItem("urlpub")||"http://default-url",e.port=localStorage.getItem("hotelport")||"default-port",e.apiBaseUrl=`${e.serverUrl}:${e.port}/hotel`})()}refreshProcedure(){this.executeProcedure(),this.executeProcedure1(),this.initializeCharts(),this.fetchData(),this.fetchMoisData(),this.fetchMuisssData()}executeProcedure(){this.http.get(`${this.apiBaseUrl}/GetDataproce`).subscribe(e=>{const{codhotelnew:n,dd:o,six:r}=e,l=localStorage.getItem("sessionId");!l||!o||!r||(this.http.get(`${this.apiBaseUrl}/init_jour_prev?d1=${o}&d2=${r}&session_=${l}`).subscribe(),this.http.get(`${this.apiBaseUrl}/generer_prev_agence_mobile?cod_agence_=&offre_=&typ_eb=0&eb_=&d1=${o}&d2=${r}&session_=${l}&cod_hotel_=${n}`).subscribe(),this.fetchData(),this.initializeCharts(),this.fetchMoisData())},e=>console.error("Error in executeProcedure:",e))}executeProcedure1(){this.http.get(`${this.apiBaseUrl}/GetDataproce`).subscribe(e=>{const{codhotelnew:n,hierPass:o,setHier:r}=e,l=localStorage.getItem("sessionId");!l||!o||!r||(this.http.get(`${this.apiBaseUrl}/init_jour_prev_mobile?d1=${o}&d2=${r}&session_=${l}`).subscribe(),this.http.get(`${this.apiBaseUrl}/generer_prev_agence_mobile1?cod_agence_=&offre_=&typ_eb=0&eb_=&d1=${o}&d2=${r}&session_=${l}&cod_hotel_=${n}`).subscribe(()=>this.fetchMuisssData()))},e=>console.error("Error in executeProcedure1:",e))}fetchData(){const e=localStorage.getItem("sessionId");this.http.get(`${this.apiBaseUrl}/getlistagencejour/${e}`).subscribe(n=>this.rows=n,n=>console.error("Failed to fetch rows data:",n))}fetchMoisData(){const e=localStorage.getItem("sessionId");this.http.get(`${this.apiBaseUrl}/getlistmois/${e}`).subscribe(n=>{this.moiss=n,this.totalPrixMoiss=this.moiss.reduce((o,r)=>o+r.prix,0)},n=>console.error("Failed to fetch monthly data:",n))}fetchMuisssData(){const e=localStorage.getItem("sessionId");this.http.get(`${this.apiBaseUrl}/getlistmoiss/${e}`).subscribe(n=>{this.muisss=n,this.totalPrixMuisss=this.muisss.reduce((o,r)=>o+r.prix,0)},n=>console.error("Failed to fetch muisss data:",n))}openRowDetails(e){this.router.navigate(["/deteilagence",e,{nom:e}])}initializeCharts(){const e=localStorage.getItem("sessionId");this.http.get(`${this.apiBaseUrl}/getlistagencejour/${e}`).subscribe(n=>{const o=n.map(g=>g.nom),r=n.map(g=>parseFloat(g.prix));this.chart&&this.chart.destroy();const l=document.getElementById("pieChart12");l&&(this.chart=new _.ZP(l,{type:"pie",data:{labels:o,datasets:[{data:r,backgroundColor:["#ff6f61","#24c1f2","#ffb6c1","#32cd32"],borderColor:"#ffffff",borderWidth:1}]},options:{responsive:!0,plugins:{legend:{display:!0,position:"right"}}}}))},n=>console.error("Failed to initialize chart:",n))}doRefresh(e){setTimeout(()=>{this.refreshProcedure(),e.target.complete()},2e3)}ngOnInit(){var e=this;return(0,p.Z)(function*(){yield e.loadConfig(),e.refreshProcedure()})()}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(m.eN),t.Y36(h.F0))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-invitefriend"]],decls:79,vars:28,consts:[[1,"ion-no-border"],[2,"text-align","center"],["slot","end",2,"display","flex","justify-content","center","align-items","center"],[2,"display","flex","justify-content","center","align-items","center","color","black","font-family","'Lucida Sans', 'Lucida Sans Regular', 'Lucida Grande', 'Lucida Sans Unicode', Geneva, Verdana, sans-serif","margin","6%"],["slot","end"],[1,"refresh-button",3,"click"],["loading","lazy","src","../../../assets/icon/arrows-rotate-solid.svg","alt","refresh"],[1,"night-mode"],["slot","fixed",3,"ionRefresh"],["pullingIcon","arrow-dropdown","pullingText","Pull to refresh","refreshingSpinner","bubbles","refreshingText","Actualiser..."],["size","12","size-md","6","offset-md","3"],[1,"section"],[1,"table-title"],[1,"chart-container"],["id","pieChart12"],[1,"table-subtitle"],[1,"table-container"],[1,"data-grid"],[1,"table"],[4,"ngFor","ngForOf"],[3,"click",4,"ngIf"],[3,"click"]],template:function(e,n){1&e&&(t.TgZ(0,"ion-header",0)(1,"ion-toolbar"),t._UZ(2,"ion-title",1),t.TgZ(3,"ion-buttons",2)(4,"p",3),t._uU(5),t.ALo(6,"date"),t.qZA()(),t.TgZ(7,"ion-buttons",4)(8,"ion-button",5),t.NdJ("click",function(){return n.refreshProcedure()}),t._UZ(9,"img",6),t.qZA()()()(),t.TgZ(10,"ion-content",7)(11,"ion-refresher",8),t.NdJ("ionRefresh",function(r){return n.doRefresh(r)}),t._UZ(12,"ion-refresher-content",9),t.qZA(),t.TgZ(13,"ion-grid")(14,"ion-row")(15,"ion-col",10)(16,"div",11)(17,"h1",12),t._uU(18),t.ALo(19,"date"),t.qZA(),t.TgZ(20,"ion-card")(21,"div",13),t._UZ(22,"canvas",14),t.qZA()()()()(),t.TgZ(23,"ion-row")(24,"ion-col",10)(25,"div",11)(26,"h1",12),t._uU(27,"Chiffre d'affaire par agence / pr\xe9visionnel"),t.qZA(),t.TgZ(28,"h3")(29,"p",15),t._uU(30),t.ALo(31,"date"),t.ALo(32,"date"),t.qZA()(),t.TgZ(33,"div",16)(34,"ion-grid",17)(35,"table",18)(36,"thead")(37,"tr")(38,"th"),t._uU(39,"Nom"),t.qZA(),t.TgZ(40,"th"),t._uU(41,"C.A DT"),t.qZA()()(),t.TgZ(42,"tbody"),t.YNc(43,b,2,1,"ng-container",19),t.TgZ(44,"tr")(45,"td")(46,"strong"),t._uU(47,"Total"),t.qZA()(),t.TgZ(48,"td")(49,"strong"),t._uU(50),t.qZA()()()()()()()()()(),t.TgZ(51,"ion-row")(52,"ion-col",10)(53,"div",11)(54,"h1",12),t._uU(55,"Chiffre d'affaire par agence / r\xe9alis\xe9"),t.qZA(),t.TgZ(56,"h3")(57,"p",15),t._uU(58),t.ALo(59,"date"),t.ALo(60,"date"),t.qZA()(),t.TgZ(61,"div",16)(62,"ion-grid",17)(63,"table",18)(64,"thead")(65,"tr")(66,"th"),t._uU(67,"Nom"),t.qZA(),t.TgZ(68,"th"),t._uU(69,"C.A DT"),t.qZA()()(),t.TgZ(70,"tbody"),t.YNc(71,P,2,1,"ng-container",19),t.TgZ(72,"tr")(73,"td")(74,"strong"),t._uU(75,"Total"),t.qZA()(),t.TgZ(76,"td")(77,"strong"),t._uU(78),t.qZA()()()()()()()()()()()()),2&e&&(t.xp6(5),t.hij(" ",t.xi3(6,10,n.currentDate,"dd/MM/yyyy")," "),t.xp6(13),t.hij("Pr\xe9vision Chiffre d'affaire par agence - ",t.xi3(19,13,n.currentDate,"dd/MM/yyyy"),""),t.xp6(12),t.AsE("P\xe9riode: ",t.xi3(31,16,n.currentDate,"dd/MM/yyyy")," au ",t.xi3(32,19,n.nextMonth,"dd/MM/yyyy"),""),t.xp6(13),t.Q6J("ngForOf",n.moiss),t.xp6(7),t.Oqu(n.totalPrixMoiss),t.xp6(8),t.AsE("P\xe9riode: ",t.xi3(59,22,n.previousMonth,"dd/MM/yyyy")," au ",t.xi3(60,25,n.yesterday,"dd/MM/yyyy"),""),t.xp6(13),t.Q6J("ngForOf",n.muisss),t.xp6(7),t.Oqu(n.totalPrixMuisss))},dependencies:[d.sg,d.O5,s.YG,s.Sm,s.PM,s.wI,s.W2,s.jY,s.Gu,s.nJ,s.Wo,s.Nd,s.wd,s.sr,d.uU],styles:[".center-title[_ngcontent-%COMP%]{display:flex;justify-content:center;width:100%;position:absolute;text-align:center;left:0;top:0;height:100%;align-items:center;color:#080808}.date-button[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;margin-right:1rem}.date-text[_ngcontent-%COMP%]{color:#343a40;font-family:Lucida Sans,sans-serif;margin:0}.refresh-button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:24px;height:24px}.section[_ngcontent-%COMP%]{margin-bottom:3%}.table-title[_ngcontent-%COMP%]{font-size:1.25rem;color:#343a40;text-align:center;padding:1rem;border-radius:8px;box-shadow:0 2px 4px #0000001a;background-color:#fff}.table-subtitle[_ngcontent-%COMP%]{font-size:1rem;color:#343a40;margin-top:.5rem;text-align:center}.table-container[_ngcontent-%COMP%]{background-color:#fff;color:#343a40;text-align:center;padding:1rem;border-radius:8px;box-shadow:0 2px 4px #0000001a;overflow-x:auto}.table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{text-align:center;padding:.75rem;border:1px solid #dee2e6}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#007bff;color:#fff}.table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(even){background-color:#f2f2f2}.chart-container[_ngcontent-%COMP%]{width:100%;height:100%;position:relative;display:flex;justify-content:center;align-items:center}@media (max-width: 768px){.table-title[_ngcontent-%COMP%]{font-size:1.1rem}.table-subtitle[_ngcontent-%COMP%]{font-size:.9rem}.date-text[_ngcontent-%COMP%]{font-size:.8rem}.refresh-button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:20px;height:20px}.chart-container[_ngcontent-%COMP%]{width:90%;height:auto}#pieChart12[_ngcontent-%COMP%]{width:100%!important;height:auto!important}}@media (max-width: 480px){.table-title[_ngcontent-%COMP%]{font-size:1rem}.table-subtitle[_ngcontent-%COMP%]{font-size:.85rem}.date-text[_ngcontent-%COMP%]{font-size:.75rem}.chart-container[_ngcontent-%COMP%]{width:100%;padding:1rem}#pieChart12[_ngcontent-%COMP%]{width:100%!important;height:100%!important}}.text-center[_ngcontent-%COMP%]{text-align:center}.text-dark[_ngcontent-%COMP%]{color:#000}"]}),i})()}];let v=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[h.Bz.forChild(y),h.Bz]}),i})(),C=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[d.ez,f.u5,s.Pc,v]}),i})()}}]);