"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4297],{4297:(S,C,d)=>{d.r(C),d.d(C,{HelpPageModule:()=>Z});var D=d(4755),M=d(5030),l=d(626),P=d(2443),b=d(5861),h=d(8053),r=d(3020),m=d(3144),R=d(9953),x=d(9751),A=d(849);let k=(()=>{class o{constructor(e,t){this.http=e,this.storage=t,this.codhotel=[],this.serverUrl="",this.port="",this.storage.create(),this.initializeUrls()}initializeUrls(){var e=this;return(0,b.Z)(function*(){e.serverUrl=localStorage.getItem("urlpub")||"http://default-url",e.port=localStorage.getItem("hotelport")||"default-port",e.firstUrl=`${e.serverUrl}:${e.port}/hotel/GetDataproce`,e.secondUrl=`${e.serverUrl}:${e.port}/hotel/categ_dispo_mobile`})()}getDataForSecondUrl(){return this.firstUrl?this.http.get(this.firstUrl):new x.y(e=>{e.error("First URL not initialized properly")})}executeProcedure(e){const t=(new m.LE).set("codhotel",e.codhotelnew);return console.log("show me the code "+e.codhotelnew),this.secondUrl?this.http.get(this.secondUrl,{params:t}):new x.y(a=>{a.error("Second URL not initialized properly")})}}return o.\u0275fac=function(e){return new(e||o)(r.LFG(m.eN),r.LFG(A.K))},o.\u0275prov=r.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var E=d(6457);const U=["pieCanvas"],z=[{path:"",component:(()=>{class o{RefreshProcedure(){this.Executeprocdispo.getDataForSecondUrl().subscribe(e=>{this.Executeprocdispo.executeProcedure(e).subscribe(a=>{})}),this.RefreshProceduredispo(),this.procedurecateg.getAndExecuteProcedure().subscribe(e=>{console.log("Procedure executed successfully getAndExecuteProcedure",e)},e=>{console.error("Error executing procedure",e)}),this.refresh()}constructor(e,t,a,s,i,n){this.http=e,this.hotelservice=t,this.ngZone=a,this.Executeprocdispo=s,this.procedurecateg=i,this.storage=n,this.serverUrl="",this.currentDate=new Date,this.DataapiArray=[],this.Datareserv=[],this.datachambredispo1="",this.DataAPI="",this.dataarrdep="",this.datareser="",this.Datareser={getwalikingtday:"",getreserve:""},this.fifthday=new Date,this.sixday=new Date,this.sevenday=new Date,this.adrese="",this.port="",this.firstday=new Date,this.secondday=new Date,this.thirdday=new Date,this.tomorrow=new Date,this.DataARRDEP={ArrivePrevus:"",Arrive:"",DepartPrevus:"",Depart:"",today:""},this.Datdispo={nbr:"",cod_categ:""},this.isLive=!1,this.isNightMode=!1,this.refreshProgress=0}toggleLiveStatus(){this.isLive=!this.isLive}loadConfig(){var e=this;return(0,b.Z)(function*(){e.serverUrl=localStorage.getItem("urlpub")||"http://default-url",e.port=localStorage.getItem("hotelport")||"default-port"})()}refreshCharts(){this.createChartchh(),this.RefreshProceduredispo(),this.readAPI(this.datachambredispo1).subscribe(e=>{const t=e.map(a=>({cod_categ:a.cod_categ,nbr:a.nbr}));this.createPieChart(t)})}refresh(){this.Executeprocdispo.getDataForSecondUrl().subscribe(e=>{this.Executeprocdispo.executeProcedure(e).subscribe(a=>{})}),this.RefreshProceduredispo(),this.procedurecateg.getAndExecuteProcedure().subscribe(e=>{console.log("Procedure executed successfully getAndExecuteProcedure",e)},e=>{console.error("Error executing procedure",e)})}toggleNightMode(){this.isNightMode=!this.isNightMode}ngOnInit(){var e=this;return(0,b.Z)(function*(){yield e.loadConfig(),e.refreshCharts(),e.createChartchh(),e.DataAPI=`${e.serverUrl}:${e.port}/hotel/countRack`,localStorage.getItem("sessionId"),e.dataarrdep=`${e.serverUrl}:${e.port}/hotel/getdataarrdep`,e.datareser=`${e.serverUrl}:${e.port}/hotel/getwalk`,e.datachambredispo1=`${e.serverUrl}:${e.port}/hotel/getchambredispo1`,e.readAPI(e.dataarrdep).subscribe(a=>{e.DataARRDEP.ArrivePrevus=a.arr_prev,e.DataARRDEP.Arrive=a.per_arr_prev,e.DataARRDEP.DepartPrevus=a.dep_prev,e.DataARRDEP.Depart=a.per_dep_prev,e.DataARRDEP.today=a.today,e.barChartMethod(e.DataARRDEP)}),e.readAPI(e.datareser).subscribe(a=>{e.Datareser.getwalikingtday=a.getwalikingtday}),e.procedurecateg.getAndExecuteProcedure().subscribe(a=>{console.log("Procedure executed successfully getAndExecuteProcedure",a)},a=>{console.error("Error executing procedure",a)}),e.readAPI(e.datachambredispo1).subscribe(a=>{const s=a.map(i=>({cod_categ:i.cod_categ,nbr:i.nbr}));e.createPieChart(s)}),e.RefreshProceduredispo(),e.currentDate.setDate(e.currentDate.getDate()),e.tomorrow.setDate(e.currentDate.getDate()+1),e.firstday.setDate(e.currentDate.getDate()+2),e.secondday.setDate(e.currentDate.getDate()+3),e.thirdday.setDate(e.currentDate.getDate()+4),e.fifthday.setDate(e.currentDate.getDate()+5),e.sixday.setDate(e.currentDate.getDate()+6),e.sevenday.setDate(e.currentDate.getDate()+7),e.RefreshProceduredispo()})()}RefreshProceduredispo(){var e=this;return(0,b.Z)(function*(){e.Executeprocdispo.getDataForSecondUrl().subscribe(t=>{e.Executeprocdispo.executeProcedure(t).subscribe(s=>{})}),e.procedurecateg.getAndExecuteProcedure().subscribe(t=>{console.log("Procedure executed successfully getAndExecuteProcedure",t)},t=>{console.error("Error executing procedure",t)}),yield e.loadDataAndCharts()})()}readAPI(e){return this.http.get(e)}loadDataAndCharts(){var e=this;return(0,b.Z)(function*(){e.DataAPI=`${e.serverUrl}:${e.port}/hotel/countRack`,e.dataarrdep=`${e.serverUrl}:${e.port}/hotel/getdataarrdep`,e.datareser=`${e.serverUrl}:${e.port}/hotel/getwalk`,e.datachambredispo1=`${e.serverUrl}:${e.port}/hotel/getchambredispo1`;try{const t=yield e.readAPI(e.dataarrdep).toPromise();e.DataARRDEP={ArrivePrevus:t.arr_prev,Arrive:t.per_arr_prev,DepartPrevus:t.dep_prev,Depart:t.per_dep_prev,today:t.today},e.barChartMethod(e.DataARRDEP);const a=yield e.readAPI(e.datareser).toPromise();e.Datareser.getwalikingtday=a.getwalikingtday,e.BarChart1(e.Datareser);const i=(yield e.readAPI(e.datachambredispo1).toPromise()).map(n=>({cod_categ:n.cod_categ,nbr:n.nbr}));e.createPieChart(i)}catch(t){console.error("Error loading chart data:",t)}})()}barChartMethod(e){const t=[e.ArrivePrevus,e.Arrive,e.DepartPrevus,e.Depart],s=document.getElementById("occupchart2"),i=h.kL.getChart(s);i&&i.destroy();const n=Math.max(...t),p=this.getStepSize(n);this.chart=new h.kL(s,{type:"bar",data:{labels:["Arriv\xe9es pr\xe9vues","Arriv\xe9es Effectu\xe9es","D\xe9parts pr\xe9vus","D\xe9parts Effectu\xe9s"],datasets:[{label:"",data:t,backgroundColor:["orange","orange","blue","blue"],borderWidth:2,borderRadius:12,hoverBorderWidth:3}]},options:{responsive:!0,maintainAspectRatio:!1,animation:{duration:2e3,easing:"easeOutBounce"},scales:{y:{beginAtZero:!0,grid:{color:"rgba(200, 200, 200, 0.3)"},ticks:{stepSize:p,font:{size:14,family:"Arial"},color:"#333"}},x:{ticks:{font:{size:14,family:"Arial"},color:"#333"}}},plugins:{legend:{display:!1,position:"top"}}}})}getStepSize(e){return e<=50?10:e<=500?20:e<=1e3?100:200}BarChart1(e){const t=[e.getwalikingtday],a=document.getElementById("myCh5"),s=h.kL.getChart(a);s&&s.destroy();const i=a.getContext("2d");if(!i)return void console.error("Unable to get 2D context for canvas");const n=i.createLinearGradient(0,0,0,400);n.addColorStop(0,"rgba(255, 99, 132, 0.5)"),n.addColorStop(1,"rgba(54, 162, 235, 0.5)");const p=this.getStepSize(t[0]);this.chart=new h.kL(a,{type:"bar",data:{labels:["WalkIN"],datasets:[{label:"Walk-In",data:t,backgroundColor:n,borderWidth:2,borderRadius:12}]},options:{responsive:!0,animation:{duration:2e3,easing:"easeOutBounce"},scales:{y:{beginAtZero:!0,grid:{color:"rgba(200, 200, 200, 0.3)"},ticks:{stepSize:p,font:{size:14,family:"Arial"},color:"#333"}},x:{ticks:{font:{size:14,family:"Arial"},color:"#333"}}},plugins:{title:{display:!0,text:"Walk-In Statistics"}}}})}createPieChart(e){if(0===e.length)return;let t=[],a=[],s=e.reduce((c,g)=>c+g.nbr,0);for(let c of e)"object"==typeof c&&"nbr"in c&&"cod_categ"in c&&(t.push(c.nbr/s*100),a.push(`${c.cod_categ} (${(c.nbr/s*100).toFixed(2)}%)`));let i=document.getElementById("pieChart4");h.kL.getChart(i);let p=new h.kL(i,{type:"pie",data:{labels:a,datasets:[{data:t,backgroundColor:["#ff6f61","#f9d423","#24c1f2","#ffb6c1","#8b4513","#ff6347","#4682b4","#32cd32","#ff4500","#6a5acd","#ffd700","#dc143c","#adff2f","#00ced1","#1e90ff","#ff1493","#9932cc","#ff69b4","#ba55d3","#ff00ff","#cd5c5c","#ffa07a","#8a2be2","#ffdab9","#87cefa","#3cb371","#808000","#b03060","#00ff7f","#6495ed"]}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!0,position:"right",labels:{boxWidth:10,font:{size:8}}},tooltip:{callbacks:{label:function(c){return`${c.label}: ${c.raw.toFixed(2)}%`}}},datalabels:{display:!0,color:"black",font:{size:6},formatter:(c,g)=>{var f;return(null===(f=g.chart.data.labels)||void 0===f?void 0:f[g.dataIndex])||""}}},layout:{padding:10},aspectRatio:1}});i.addEventListener("click",c=>{let g=p.getElementsAtEventForMode(c,"nearest",{intersect:!0},!0);g.length>0&&this.openDetailsChart(a[g[0].index])})}openDetailsChart(e){var t=this;return(0,b.Z)(function*(){const a=["Janvier","F\xe9vrier","Mars","Avril","Mai","Juin","Juillet","Ao\xfbt","Septembre","Octobre","Novembre","D\xe9cembre"],s=n=>`${n.getDate()} ${a[n.getMonth()]}`,i=[s(t.tomorrow),s(t.firstday),s(t.secondday),s(t.thirdday),s(t.fifthday),s(t.sixday)];try{const n=yield fetch(`${t.serverUrl}:${t.port}/hotel/getprevcateg`);if(!n.ok)throw new Error("Failed to fetch data");const p=yield n.json(),c=e.split("(")[0].trim(),f=p.filter(y=>y.cod_CATEG===c).map(y=>y.rest),v=document.getElementById("detailsChart6");if(!v)return;const w=h.kL.getChart(v);w&&w.destroy(),new h.kL(v,{type:"bar",data:{labels:i,datasets:[{label:`${c} Details`,data:f,backgroundColor:["blue","blue","blue","blue","blue","blue"],borderColor:"blue",borderWidth:2,borderRadius:12,hoverBorderColor:"#FF6384",hoverBorderWidth:3}]},options:{responsive:!0,scales:{y:{beginAtZero:!0,grid:{color:"rgba(200, 200, 200, 0.3)"},ticks:{font:{size:14,family:"Arial"},color:"#333"}},x:{ticks:{font:{size:14,family:"Arial"},color:"#333"}}},plugins:{legend:{display:!0,position:"top",labels:{font:{size:16,family:"Arial"},color:"#555"}},tooltip:{callbacks:{label:y=>`Revenue: ${y.parsed.y} `},backgroundColor:"rgba(0, 0, 0, 0.7)",titleFont:{size:14},bodyFont:{size:12},padding:10}},animation:{duration:2e3,easing:"easeOutBounce"},hover:{mode:"nearest",intersect:!0}}})}catch(n){console.error("Error fetching data:",n)}})()}createChartchh(){this.http.get(`${this.serverUrl}:${this.port}/hotel/getchhotel`).subscribe(t=>{const a=t.map(i=>{const n=new Date(i.dat_rev);return`${n.getDate().toString().padStart(2,"0")}/${(n.getMonth()+1).toString().padStart(2,"0")}/${n.getFullYear()}`}),s=t.map(i=>i.chiffre);this.chart&&this.chart.destroy(),this.chart=new h.kL("MyChartch1",{type:"line",data:{labels:a,datasets:[{label:"Chiffre (Revenue)",data:s,backgroundColor:"rgba(75, 192, 192, 0.2)",borderColor:"#4BC0C0",borderWidth:3,pointBackgroundColor:"#4BC0C0",pointBorderColor:"#fff",pointRadius:6,pointHoverRadius:8,tension:.4,fill:!0}]},options:{responsive:!0,maintainAspectRatio:!1,animation:{duration:1200,easing:"easeInOutCubic"},plugins:{legend:{position:"top",labels:{font:{size:14,weight:600},color:"#4BC0C0"}},tooltip:{backgroundColor:"#333",titleFont:{size:16,weight:600},bodyFont:{size:14},callbacks:{label:i=>`Chiffre: ${i.raw.toLocaleString()}`}}},scales:{x:{title:{display:!0,text:"Date",color:"#4BC0C0",font:{size:14,weight:600}},ticks:{color:"#4BC0C0",maxRotation:45,minRotation:45},grid:{color:"rgba(220, 220, 220, 0.5)"}},y:{beginAtZero:!0,ticks:{color:"#4BC0C0",padding:8},grid:{color:"rgba(220, 220, 220, 0.5)"}}},layout:{padding:{top:20,bottom:10,left:15,right:15}}}})},t=>{console.error("Error fetching data",t)})}}return o.\u0275fac=function(e){return new(e||o)(r.Y36(m.eN),r.Y36(R.N),r.Y36(r.R0b),r.Y36(k),r.Y36(E.s),r.Y36(A.K))},o.\u0275cmp=r.Xpm({type:o,selectors:[["app-help"]],viewQuery:function(e,t){if(1&e&&r.Gf(U,5),2&e){let a;r.iGM(a=r.CRH())&&(t.pieCanvas=a.first)}},decls:41,vars:4,consts:[[1,"ion-no-border"],[2,"font-size","13px","margin-left","3%","text-align","center"],["slot","end",2,"display","flex","justify-content","center","align-items","center"],[1,"mb-0",2,"display","flex","justify-content","center","align-items","center","color","black","font-family","'Lucida Sans', Geneva, sans-serif","margin","6%"],["slot","end"],[1,"refrech-button",3,"click"],["src","../../../assets/icon/arrows-rotate-solid.svg","alt","refresh"],[1,"content"],[1,"container"],[1,"bg-white","text-center","text-dark"],["size","12","size-md","12"],[1,"chart-container"],["id","occupchart2"],["size","12","size-md","6","offset-md","3"],["id","myCh5"],[1,"large-chart-container"],["id","pieChart4",2,"width","150px","height","150px"],["id","detailsChart6",2,"height","200px"],["id","MyChartch1"]],template:function(e,t){1&e&&(r.TgZ(0,"ion-header",0)(1,"ion-toolbar"),r._UZ(2,"ion-title",1),r.TgZ(3,"ion-buttons",2)(4,"p",3),r._uU(5),r.ALo(6,"date"),r.qZA()(),r.TgZ(7,"ion-buttons",4)(8,"ion-button",5),r.NdJ("click",function(){return t.RefreshProcedure()}),r._UZ(9,"img",6),r.qZA()()()(),r.TgZ(10,"ion-content",7)(11,"ion-grid",8)(12,"h1",9),r._uU(13,"\xc9tat Global"),r.qZA(),r.TgZ(14,"ion-row")(15,"ion-col",10)(16,"ion-card")(17,"div",11),r._UZ(18,"canvas",12),r.qZA()()()(),r.TgZ(19,"ion-row")(20,"ion-col",13)(21,"ion-card")(22,"div",11),r._UZ(23,"canvas",14),r.qZA()()()(),r.TgZ(24,"h1",9),r._uU(25,"Cat\xe9gories Disponibles"),r.qZA(),r.TgZ(26,"ion-row",9)(27,"ion-col",10)(28,"ion-card")(29,"div",15),r._UZ(30,"canvas",16),r.qZA()()()(),r.TgZ(31,"ion-row",9)(32,"ion-col",10)(33,"ion-card")(34,"div",11),r._UZ(35,"canvas",17),r.qZA()()()(),r.TgZ(36,"ion-row",9)(37,"ion-col",10)(38,"ion-card")(39,"div",11),r._UZ(40,"canvas",18),r.qZA()()()()()()),2&e&&(r.xp6(5),r.hij(" ",r.xi3(6,1,t.currentDate,"dd/MM/yyyy")," "))},dependencies:[l.YG,l.Sm,l.PM,l.wI,l.W2,l.jY,l.Gu,l.Nd,l.wd,l.sr,D.uU],styles:["ion-toolbar[_ngcontent-%COMP%]{--background: white}.text-center[_ngcontent-%COMP%]{text-align:center}.bg-white[_ngcontent-%COMP%]{background-color:#fff}.text-dark[_ngcontent-%COMP%]{color:#000}.container[_ngcontent-%COMP%]{padding:10px}.chart-container[_ngcontent-%COMP%], .large-chart-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:100%;height:100%;padding:10px;box-sizing:border-box}canvas[_ngcontent-%COMP%]{width:100%!important;height:100%!important}@media only screen and (max-width: 600px){ion-title[_ngcontent-%COMP%]{font-size:12px;text-align:center}.container[_ngcontent-%COMP%]{padding:5px}.chart-container[_ngcontent-%COMP%]{height:250px}.bg-white[_ngcontent-%COMP%]{font-size:16px}.large-chart-container[_ngcontent-%COMP%]{height:300px}}@media only screen and (min-width: 600px) and (max-width: 1024px){ion-title[_ngcontent-%COMP%]{font-size:15px}.container[_ngcontent-%COMP%]{padding:15px}.chart-container[_ngcontent-%COMP%]{height:280px}}@media only screen and (min-width: 1025px){ion-title[_ngcontent-%COMP%]{font-size:18px}.container[_ngcontent-%COMP%]{padding:20px}.chart-container[_ngcontent-%COMP%]{height:400px}.large-chart-container[_ngcontent-%COMP%]{height:500px}}@media only screen and (orientation: landscape){ion-toolbar[_ngcontent-%COMP%]{height:50px}ion-card[_ngcontent-%COMP%]{margin:10px}.chart-container[_ngcontent-%COMP%]{height:250px}}"]}),o})()}];let $=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=r.oAB({type:o}),o.\u0275inj=r.cJS({imports:[P.Bz.forChild(z),P.Bz]}),o})(),Z=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=r.oAB({type:o}),o.\u0275inj=r.cJS({imports:[D.ez,M.u5,l.Pc,$]}),o})()}}]);