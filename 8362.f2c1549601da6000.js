"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[8362],{8362:(q,p,s)=>{s.r(p),s.d(p,{HomePageModule:()=>D});var d=s(4755),f=s(5030),c=s(626),h=s(2443),u=s(5861),x=s(3144),m=s(8053),b=s(9751),t=s(3020),P=s(849);const _=["lineCanvas"],Z=function(n,r){return{"table-primary":n,"table-success":r}};function O(n,r){if(1&n&&(t.TgZ(0,"tr",23)(1,"td",24),t._uU(2),t.ALo(3,"titlecase"),t.qZA(),t.TgZ(4,"td",24),t._uU(5),t.qZA(),t.TgZ(6,"td",24),t._uU(7),t.qZA(),t.TgZ(8,"td",24),t._uU(9),t.qZA(),t.TgZ(10,"td",25),t._uU(11),t.qZA()()),2&n){const e=r.$implicit,o=r.index;t.Q6J("ngClass",t.WLB(8,Z,2===o,4===o)),t.xp6(2),t.Oqu(t.lcZ(3,6,e.labelle)),t.xp6(3),t.Oqu(e.chambre),t.xp6(2),t.hij("",e.tau,"% "),t.xp6(2),t.hij("",e.pax," "),t.xp6(2),t.hij("",e.taux,"% ")}}function C(n,r){if(1&n&&(t.TgZ(0,"ion-card")(1,"table",20)(2,"thead")(3,"tr")(4,"th",21),t._uU(5,"Libell\xe9"),t.qZA(),t.TgZ(6,"th",21),t._uU(7,"Chambre"),t.qZA(),t.TgZ(8,"th",21),t._uU(9,"%T.O"),t.qZA(),t.TgZ(10,"th",21),t._uU(11,"Pax"),t.qZA(),t.TgZ(12,"th",21),t._uU(13,"%T.O"),t.qZA()()(),t.TgZ(14,"tbody"),t.YNc(15,O,12,11,"tr",22),t.qZA()()()),2&n){const e=t.oxw();t.xp6(15),t.Q6J("ngForOf",e.DataOccupation)}}function T(n,r){if(1&n&&(t.TgZ(0,"tr")(1,"td",24),t._uU(2),t.qZA(),t.TgZ(3,"td",24),t._uU(4),t.qZA(),t.TgZ(5,"td",24),t._uU(6),t.qZA(),t.TgZ(7,"td",24),t._uU(8),t.qZA(),t.TgZ(9,"td",27),t._uU(10),t.qZA()()),2&n){const e=r.$implicit;t.xp6(2),t.Oqu(e.jour),t.xp6(2),t.Oqu(e.dep_chb),t.xp6(2),t.Oqu(e.arr_chb),t.xp6(2),t.Oqu(e.chb),t.xp6(2),t.hij("",e.taux_chb,"% ")}}function v(n,r){if(1&n&&(t.TgZ(0,"ion-card")(1,"table",20)(2,"thead")(3,"tr")(4,"th",21),t._uU(5,"Journ\xe9e"),t.qZA(),t.TgZ(6,"th",21),t._uU(7,"D\xe9part"),t.qZA(),t.TgZ(8,"th",21),t._uU(9,"Arriv\xe9e"),t.qZA(),t.TgZ(10,"th",21),t._uU(11,"Chambre"),t.qZA(),t.TgZ(12,"th",21),t._uU(13,"%T.O"),t.qZA()()(),t.TgZ(14,"tbody"),t.YNc(15,T,11,5,"tr",26),t.qZA()()()),2&n){const e=t.oxw();t.xp6(15),t.Q6J("ngForOf",e.DataOccupationPrev)}}function M(n,r){if(1&n&&(t.TgZ(0,"tr")(1,"td",24),t._uU(2),t.qZA(),t.TgZ(3,"td",24),t._uU(4),t.qZA(),t.TgZ(5,"td",24),t._uU(6),t.qZA(),t.TgZ(7,"td",24),t._uU(8),t.qZA(),t.TgZ(9,"td",28),t._uU(10),t.qZA()()),2&n){const e=r.$implicit;t.xp6(2),t.Oqu(e.jour),t.xp6(2),t.Oqu(e.dep_pax),t.xp6(2),t.Oqu(e.arr_pax),t.xp6(2),t.Oqu(e.pax),t.xp6(2),t.hij("",e.taux_pax,"% ")}}function U(n,r){if(1&n&&(t.TgZ(0,"ion-card")(1,"table",20)(2,"thead")(3,"tr")(4,"th",21),t._uU(5,"Journ\xe9e"),t.qZA(),t.TgZ(6,"th",21),t._uU(7,"D\xe9part"),t.qZA(),t.TgZ(8,"th",21),t._uU(9,"Arriv\xe9e"),t.qZA(),t.TgZ(10,"th",21),t._uU(11,"Pax"),t.qZA(),t.TgZ(12,"th",21),t._uU(13,"%T.O"),t.qZA()()(),t.TgZ(14,"tbody"),t.YNc(15,M,11,5,"tr",26),t.qZA()()()),2&n){const e=t.oxw();t.xp6(15),t.Q6J("ngForOf",e.DataPaxOccupationPrev)}}const y=[{path:"",component:(()=>{class n{RefreshProcedure(){throw new Error("Method not implemented.")}constructor(e,o){this.http=e,this.storage=o,this.DataPaxOccupation=[],this.tauxnbrpax=[],this.jour=[],this.rows=[],this.fifthday=new Date,this.sixday=new Date,this.sevenday=new Date,this.residents=[],this.DataPaxOccupationPrev=[],this.DataOccupation=[],this.DataOccupationPrev=[],this.isDataLoaded=!1,this.tauxnbr=[],this.currentDate=new Date,this.serverUrl="",this.port="",this.initializeStorage()}loadConfig(){var e=this;return(0,u.Z)(function*(){e.serverUrl=localStorage.getItem("urlpub")||"http://default-url",e.port=localStorage.getItem("hotelport")||"default-port"})()}initializeStorage(){var e=this;return(0,u.Z)(function*(){yield e.storage.create()})()}ngOnInit(){var e=this;return(0,u.Z)(function*(){yield e.loadConfig(),e.loadData()})()}getDataForSecondUrl(e){const o=`${e}/GetDataproce`;return console.log("Fetching data from: ",o),this.http.get(o)}executeProcedure(e,o){const a=localStorage.getItem("sessionId");if(!a)return console.error("Session ID is missing!"),new b.y(i=>{i.error("Session ID is missing!"),i.complete()});const l=(new x.LE).set("cod_hotel_New",e.codhotelnew).set("d1",e.d1).set("session_id_",a),g=`${o}/getInfo_planning_apk`;return console.log("Executing procedure with params: ",l.toString()),this.http.get(g,{params:l})}getDetailsOccupation(e){const a=`${e}/getOccupationPaxDetails/${localStorage.getItem("sessionId")}`;return console.log("Fetching details occupation from: ",a),this.http.get(a)}getOccupationDetailsPrev(e){const o=localStorage.getItem("sessionId");return this.http.get(`${e}/getOccupationDetailsPrev/${o}`)}getOccupationPaxDetailsPrev(e){const a=`${e}/getOccupationPaxDetailsPrev/${localStorage.getItem("sessionId")}`;return console.log("Fetching occupation pax details prev from: ",a),this.http.get(a)}parseJour(e){const o=e.split(":");if(2===o.length){const a=parseInt(o[0],10),l=parseInt(o[1],10),g=new Date;return g.setHours(a,l),g.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}return e}loadData(){var e=this;return(0,u.Z)(function*(){if(!e.serverUrl||!e.port)return void console.error("Server URL or Port is missing!");const o=`${e.serverUrl}:${e.port}/hotel`;e.getDataForSecondUrl(o).subscribe(a=>{console.log("Data from first URL: ",a),e.executeProcedure(a,o).subscribe(l=>{e.getDetailsOccupation(o).subscribe(g=>{e.DataOccupation=g,e.isDataLoaded=!0}),e.getOccupationPaxDetailsPrev(o).subscribe(g=>{e.DataPaxOccupationPrev=g.map(i=>({...i,taux_pax:parseFloat(i.taux_pax.toFixed(2)),jour:e.parseJour(i.jour)})),e.tauxnbrpax=e.DataPaxOccupationPrev.map(i=>i.taux_pax),e.day=e.DataPaxOccupationPrev.map(i=>i.jour),e.createChart(e.tauxnbrpax,e.tauxnbr,e.day),e.isDataLoaded=!0}),e.getOccupationDetailsPrev(o).subscribe(g=>{e.DataOccupationPrev=g.map(i=>({...i,taux_chb:parseFloat(i.taux_chb.toFixed(2)),jour:e.parseJour(i.jour)})),e.tauxnbr=e.DataOccupationPrev.map(i=>i.taux_chb),e.day=e.DataOccupationPrev.map(i=>i.jour),e.createChart(e.tauxnbr,e.tauxnbrpax,e.day),e.isDataLoaded=!0})},l=>{console.error("Error in executeProcedure: ",l)})},a=>{console.error("Error fetching data from second URL: ",a)})})()}doRefresh(e){setTimeout(()=>{this.loadData(),e.target.complete()},200)}createChart(e,o,a){this.chart&&this.chart.destroy(),this.chart=new m.kL("MyChart1",{type:"line",data:{labels:a,datasets:[{label:"Pax",data:e,backgroundColor:"rgba(255, 165, 0, 0.3)",borderColor:"rgba(255, 165, 0, 1)",borderWidth:3,pointStyle:"circle",pointRadius:5,pointHoverRadius:7,fill:!0,tension:.4},{label:"Chambre",data:o,backgroundColor:"rgba(255, 0, 0, 0.3)",borderColor:"rgba(255, 0, 0, 1)",borderWidth:3,pointStyle:"rectRot",pointRadius:5,pointHoverRadius:7,fill:!0,tension:.4}]},options:{responsive:!0,plugins:{legend:{display:!0,labels:{font:{size:14,weight:"bold"},padding:20}},tooltip:{backgroundColor:"rgba(0, 0, 0, 0.8)",titleColor:"#ffffff",bodyColor:"#cccccc",bodyFont:{size:12},padding:10,cornerRadius:5,callbacks:{label:l=>`${l.dataset.label}: ${l.raw}`}}},scales:{y:{beginAtZero:!0,ticks:{color:"#555",font:{weight:"bold"}},grid:{color:"rgba(200, 200, 200, 0.5)",lineWidth:1}},x:{ticks:{color:"#333",font:{weight:600}},grid:{display:!1}}}}})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(x.eN),t.Y36(P.K))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-home"]],viewQuery:function(e,o){if(1&e&&t.Gf(_,5),2&e){let a;t.iGM(a=t.CRH())&&(o.lineCanvas=a.first)}},decls:34,vars:7,consts:[[1,"ion-no-border"],[2,"text-align","center"],["slot","end",2,"display","flex","justify-content","center","align-items","center"],[2,"display","flex","justify-content","center","align-items","center","color","black","font-family","'Lucida Sans', 'Lucida Sans Regular', 'Lucida Grande', 'Lucida Sans Unicode', Geneva, Verdana, sans-serif","margin","6%"],["slot","end"],[1,"refresh-button",3,"click"],["loading","lazy","src","../../../assets/icon/arrows-rotate-solid.svg","alt","refresh"],[1,"night-mode"],["slot","fixed",3,"ionRefresh"],["pullingIcon","arrow-dropdown","pullingText","Pull to refresh","refreshingSpinner","bubbles","refreshingText","Actualiser..."],[1,"tablette"],[2,"opacity","1"],[1,"bg-white","text-center","text-dark",2,"font-size","20px"],[4,"ngIf"],[1,"table-title","text-center","bg-white","text-dark","mt-3",2,"font-size","20px"],[1,"overflow-auto"],[1,"overflow-auto","mt-2","mb-5"],["size","12","size-md","12"],[1,"chart-container",2,"height","200px"],["id","MyChart1",2,"height","200px"],[1,"table","table-bordered"],[1,"text-center","text-dark",2,"font-size","12px"],[3,"ngClass",4,"ngFor","ngForOf"],[3,"ngClass"],[1,"text-center","text-dark",2,"font-size","12px","text-align","center"],[1,"text-center","text-dark",2,"font-size","12px","text-align","right"],[4,"ngFor","ngForOf"],[1,"text-right","text-dark",2,"font-size","12px","text-align","center"],[1,"text-right","text-dark",2,"font-size","12px","text-align","right"]],template:function(e,o){1&e&&(t.TgZ(0,"ion-header",0)(1,"ion-toolbar"),t._UZ(2,"ion-title",1),t.TgZ(3,"ion-buttons",2)(4,"p",3),t._uU(5),t.ALo(6,"date"),t.qZA()(),t.TgZ(7,"ion-buttons",4)(8,"ion-button",5),t.NdJ("click",function(){return o.RefreshProcedure()}),t._UZ(9,"img",6),t.qZA()()()(),t.TgZ(10,"ion-content",7)(11,"ion-refresher",8),t.NdJ("ionRefresh",function(l){return o.doRefresh(l)}),t._UZ(12,"ion-refresher-content",9),t.qZA(),t.TgZ(13,"ion-grid",10)(14,"ion-row")(15,"ion-col",11)(16,"h1",12),t._uU(17,"Taux d'occupation de la journ\xe9e"),t.qZA(),t.YNc(18,C,16,1,"ion-card",13),t.TgZ(19,"h1",14),t._uU(20,"Pr\xe9visions d'une semaine Chambre"),t.qZA(),t.TgZ(21,"div",15),t.YNc(22,v,16,1,"ion-card",13),t.qZA(),t.TgZ(23,"h1",14),t._uU(24,"Pr\xe9visions d'une semaine Pax"),t.qZA(),t.TgZ(25,"div",16),t.YNc(26,U,16,1,"ion-card",13),t.qZA()(),t.TgZ(27,"ion-col",17)(28,"h1",14),t._uU(29,"Pr\xe9visions Global d'une semaine "),t.qZA()(),t.TgZ(30,"ion-col",17)(31,"ion-card")(32,"div",18),t._UZ(33,"canvas",19),t.qZA()()()()()()),2&e&&(t.xp6(5),t.hij(" ",t.xi3(6,4,o.currentDate,"dd/MM/yyyy")," "),t.xp6(13),t.Q6J("ngIf",o.isDataLoaded),t.xp6(4),t.Q6J("ngIf",o.isDataLoaded),t.xp6(4),t.Q6J("ngIf",o.isDataLoaded))},dependencies:[d.mk,d.sg,d.O5,c.YG,c.Sm,c.PM,c.wI,c.W2,c.jY,c.Gu,c.nJ,c.Wo,c.Nd,c.wd,c.sr,d.rS,d.uU],styles:["ion-toolbar[_ngcontent-%COMP%]{--background: white}.text-center[_ngcontent-%COMP%]{text-align:center}.bg-white[_ngcontent-%COMP%]{background-color:#fff}.text-dark[_ngcontent-%COMP%]{color:#000}.mb-0[_ngcontent-%COMP%]{margin-bottom:0}.overflow-auto[_ngcontent-%COMP%]{overflow-x:auto}.mt-3[_ngcontent-%COMP%]{margin-top:3%}.mt-2[_ngcontent-%COMP%]{margin-top:2%}.mb-5[_ngcontent-%COMP%]{margin-bottom:5%}.refrech-button[_ngcontent-%COMP%]{--background: white}.table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;border-spacing:0}.table-bordered[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .table-bordered[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border:1px solid #ddd;padding:4px;font-size:12px}.table-primary[_ngcontent-%COMP%]{background-color:#add8e6}.table-success[_ngcontent-%COMP%]{background-color:#90ee90}.table-title[_ngcontent-%COMP%]{font-size:1.5em;margin-top:20px}.chart-container[_ngcontent-%COMP%]{position:relative;width:100%;display:flex;justify-content:center;align-items:center}canvas[_ngcontent-%COMP%]{width:100%!important;height:100%!important}@media only screen and (max-width: 600px){ion-title[_ngcontent-%COMP%]{font-size:12px;text-align:center}.mb-0[_ngcontent-%COMP%], .table-bordered[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .table-bordered[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:10px}.large-chart-container[_ngcontent-%COMP%]{height:250px}.table-title[_ngcontent-%COMP%]{font-size:1.2em}.chart-container[_ngcontent-%COMP%]{padding:10px}}@media only screen and (min-width: 600px) and (max-width: 1024px){ion-title[_ngcontent-%COMP%]{font-size:15px;text-align:center}.mb-0[_ngcontent-%COMP%]{font-size:12px}.table-bordered[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .table-bordered[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:11px}.large-chart-container[_ngcontent-%COMP%]{height:300px;padding:10px}.table-title[_ngcontent-%COMP%]{font-size:1.4em}.chart-container[_ngcontent-%COMP%]{padding:15px}}@media only screen and (min-width: 1025px){ion-title[_ngcontent-%COMP%]{font-size:18px;margin-left:3%;text-align:center}.mb-0[_ngcontent-%COMP%]{font-size:14px}.table-bordered[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .table-bordered[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:12px}.large-chart-container[_ngcontent-%COMP%]{height:350px;padding:15px}.table-title[_ngcontent-%COMP%]{font-size:1.5em}.chart-container[_ngcontent-%COMP%]{padding:20px}}"]}),n})()}];let A=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[h.Bz.forChild(y),h.Bz]}),n})(),D=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[d.ez,f.u5,c.Pc,A]}),n})()}}]);